<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸‡åœ£èŠ‚ç¥ç§˜ç¤¼ç‰©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            background: #f8f9fa;
            overflow: auto; /* å…è®¸æ»šåŠ¨ï¼Œé¿å…æ ‡ç­¾è¶…å‡ºå±å¹• */
        }
        .card {
            position: absolute;
            padding: 12px;
            border-radius: 6px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            animation: popIn 0.6s ease-out;
            cursor: move;
            z-index: 1; /* é‡å æ—¶æ˜¾ç¤ºå±‚çº§ */
        }
        @keyframes popIn {
            from { opacity: 0; transform: scale(0.3) rotate(-10deg); }
            to { opacity: 1; transform: scale(1) rotate(0); }
        }
        .card .title {
            font-weight: bold;
            color: #d9534f;
            margin-bottom: 4px;
        }
        .card .content {
            font-size: 14px;
            color: #333;
        }
        .dialog {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 999;
            text-align: center;
        }
        .dialog button {
            margin-top: 10px;
            padding: 6px 12px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="dialog" id="openDialog">
        <p>æ‚¨æœ‰ä¸€ä»½ç¥ç§˜ç¤¼ç‰©ï¼Œç¡®å®šè¦æ‰“å¼€å—ï¼Ÿ</p>
        <button onclick="openGifts()">ç¡®å®š</button>
    </div>

    <script>
        // å¤§å¹…å¢åŠ ç¥ç¦å†…å®¹ï¼Œæ ‡ç­¾æ•°é‡ç¿»å€
        const messages = [
            "ä½ è¶…æ£’çš„", "å¥½å¥½çˆ±è‡ªå·±", "æ¢¦æƒ³æˆçœŸ", "æœŸå¾…ä¸‹ä¸€æ¬¡è§é¢", "çæƒœæ¯ä¸€åˆ»",
            "æˆ‘æƒ³ä½ äº†", "å¤©å†·äº†ï¼Œå¤šç©¿è¡£æœ", "åˆ«ç†¬å¤œ", "è¦ç›¸ä¿¡è‡ªå·±", "å¤šå–æ°´å“¦~",
            "è®°å¾—å¥½å¥½æŠ¤è‚¤", "å­¦ä¼šçˆ±è‡ªå·±", "åˆ«å¤ªç´¯å•¦", "æ—©ç‚¹ä¼‘æ¯", "ä¸‡åœ£èŠ‚å¿«ä¹å‘€~",
            "ä»Šå¤©ä¹Ÿè¦å¼€å¿ƒå“¦", "ä¸€åˆ‡éƒ½ä¼šè¶Šæ¥è¶Šå¥½", "ç…§é¡¾å¥½è‡ªå·±å‘€", "åŠ æ²¹ï¼Œä½ æ˜¯æœ€æ£’çš„",
            "ä¿æŒå¾®ç¬‘ï¼Œå¥½è¿ä¼šæ¥", "å¹³å®‰å–œä¹", "ä¸‡äº‹é¡ºæ„", "å¿ƒæƒ³äº‹æˆ", "ç¦æ˜Ÿé«˜ç…§",
            "å–œä¹å®‰åº·", "å‰ç¨‹ä¼¼é”¦", "ä¸€å¸†é£é¡º", "é˜–å®¶å¹¸ç¦", "å¥½è¿è¿è¿", "ç¬‘å®¹å¸¸åœ¨",
            "æ´»åŠ›æ»¡æ»¡", "å…ƒæ°”åè¶³", "å¤©å¤©å¼€å¿ƒ", "æ— å¿§æ— è™‘", "å¥åº·å¹³å®‰", "å¿«ä¹åŠ å€"
        ];

        const colors = [
            "rgba(255, 223, 223, 0.8)",
            "rgba(223, 255, 223, 0.8)",
            "rgba(255, 255, 223, 0.8)",
            "rgba(223, 223, 255, 0.8)"
        ];

        let cards = [];
        const maxOverlapRatio = 0.3; // å…è®¸30%é‡å ï¼ˆå¯è°ƒæ•´0-1ä¹‹é—´ï¼‰

        function createCard() {
            const card = document.createElement("div");
            card.className = "card";
            const msg = messages[Math.floor(Math.random() * messages.length)];
            card.innerHTML = `<div class="title">ğŸ’– æç¤º</div><div class="content">${msg}</div>`;
            
            let isOverlap;
            let left, top;
            let attempt = 0; // é™åˆ¶å°è¯•æ¬¡æ•°ï¼Œé¿å…å¡æ­»
            do {
                isOverlap = false;
                left = Math.random() * (window.innerWidth - 160);
                top = Math.random() * (window.innerHeight - 100);
                // æ£€æµ‹é‡å ç¨‹åº¦
                for (let i = 0; i < cards.length; i++) {
                    const c = cards[i];
                    // è®¡ç®—é‡å åŒºåŸŸ
                    const overlapLeft = Math.max(left, c.left);
                    const overlapTop = Math.max(top, c.top);
                    const overlapRight = Math.min(left + 160, c.left + c.width);
                    const overlapBottom = Math.min(top + 100, c.top + c.height);
                    const overlapWidth = Math.max(0, overlapRight - overlapLeft);
                    const overlapHeight = Math.max(0, overlapBottom - overlapTop);
                    const overlapArea = overlapWidth * overlapHeight;
                    const cardArea = 160 * 100; // å½“å‰å¡ç‰‡é¢ç§¯
                    // è¶…è¿‡å…è®¸é‡å æ¯”ä¾‹åˆ™é‡æ–°ç”Ÿæˆä½ç½®
                    if (overlapArea / cardArea > maxOverlapRatio) {
                        isOverlap = true;
                        break;
                    }
                }
                attempt++;
            } while (isOverlap && attempt < 10); // æœ€å¤šå°è¯•10æ¬¡ï¼Œä»é‡å åˆ™å¼ºåˆ¶ç”Ÿæˆ

            const color = colors[Math.floor(Math.random() * colors.length)];
            const width = 140 + Math.random() * 40;
            const height = 80 + Math.random() * 30;

            card.style.left = `${left}px`;
            card.style.top = `${top}px`;
            card.style.backgroundColor = color;
            card.style.width = `${width}px`;
            card.style.height = `${height}px`;

            cards.push({ left, top, width, height });
            document.body.appendChild(card);
            dragElement(card);
        }

        function openGifts() {
            document.getElementById("openDialog").style.display = "none";
            // ç”Ÿæˆæ‰€æœ‰æ ‡ç­¾ï¼ˆæ•°é‡=messagesæ•°ç»„é•¿åº¦ï¼‰
            for (let i = 0; i < messages.length; i++) {
                setTimeout(() => createCard(), i * 200); // åŠ å¿«ç”Ÿæˆé€Ÿåº¦
            }
        }

        function dragElement(elmnt) {
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            elmnt.onmousedown = dragStart;

            function dragStart(e) {
                e.preventDefault();
                pos3 = e.clientX;
                pos4 = e.clientY;
                elmnt.style.zIndex = 99; // æ‹–æ‹½æ—¶ç½®é¡¶
                document.onmouseup = dragEnd;
                document.onmousemove = dragMove;
            }

            function dragMove(e) {
                e.preventDefault();
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;
                elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
                elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
            }

            function dragEnd() {
                elmnt.style.zIndex = 1; // æ‹–æ‹½ç»“æŸæ¢å¤å±‚çº§
                document.onmouseup = null;
                document.onmousemove = null;
            }
        }
    </script>
</body>
</html>
